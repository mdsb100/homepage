<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Documentation Source: module/Test.js</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	
	<link type="text/css" rel="stylesheet" href="styles/site.simplex.css">
	
</head>

<body>
<div class="container-fluid">
	<div class="navbar navbar-fixed-top ">
		<div class="navbar-inner">
			<a class="brand" href="index.html">Documentation</a>
			<ul class="nav">
				
				<li class="dropdown">
					<a href="namespaces.list.html" class="dropdown-toggle" data-toggle="dropdown">Namespaces<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="aQuery.util.html">util</a>
						</li>
						
						<li>
							<a href="event.document.html">document</a>
						</li>
						
						<li>
							<a href="require.html">require(namespace)</a>
						</li>
						

					</ul>
				</li>
				
				<li class="dropdown">
					<a href="modules.list.html" class="dropdown-toggle" data-toggle="dropdown">Modules<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="array.html">base/array</a>
						</li>
						
						<li>
							<a href="ClassModule.html">base/ClassModule</a>
						</li>
						
						<li>
							<a href="client.html">base/client</a>
						</li>
						
						<li>
							<a href="config.html">base/config</a>
						</li>
						
						<li>
							<a href="extend.html">base/extend</a>
						</li>
						
						<li>
							<a href="Promise.html">base/Promise</a>
						</li>
						
						<li>
							<a href="queue.html">base/queue</a>
						</li>
						
						<li>
							<a href="ready.html">base/ready</a>
						</li>
						
						<li>
							<a href="support.html">base/support</a>
						</li>
						
						<li>
							<a href="typed.html">base/typed</a>
						</li>
						
						<li>
							<a href="array_.html">ecma5/array</a>
						</li>
						
						<li>
							<a href="function.html">ecma5/function</a>
						</li>
						
						<li>
							<a href="object.html">ecma5/object</a>
						</li>
						
						<li>
							<a href="string.html">ecma5/string</a>
						</li>
						
						<li>
							<a href="charcode.html">hash/charcode</a>
						</li>
						
						<li>
							<a href="cssColors.html">hash/cssColors</a>
						</li>
						
						<li>
							<a href="applicationCache.html">html5/applicationCache</a>
						</li>
						
						<li>
							<a href="localStorage.html">html5/localStorage</a>
						</li>
						
						<li>
							<a href="sessionStorage.html">html5/sessionStorage</a>
						</li>
						
						<li>
							<a href="Storage.html">html5/Storage</a>
						</li>
						
						<li>
							<a href="Worker.html">html5/Worker</a>
						</li>
						
						<li>
							<a href="sizzle.html">lib/sizzle</a>
						</li>
						
						<li>
							<a href="attr.html">main/attr</a>
						</li>
						
						<li>
							<a href="class.html">main/class</a>
						</li>
						
						<li>
							<a href="communicate.html">main/communicate</a>
						</li>
						
						<li>
							<a href="CustomEvent.html">main/CustomEvent</a>
						</li>
						
						<li>
							<a href="data.html">main/data</a>
						</li>
						
						<li>
							<a href="event.html">main/event</a>
						</li>
						
						<li>
							<a href="object_.html">main/object</a>
						</li>
						
						<li>
							<a href="parse.html">main/parse</a>
						</li>
						
						<li>
							<a href="query.html">main/query</a>
						</li>
						
						<li>
							<a href="event_.html">mobile/event</a>
						</li>
						
						<li>
							<a href="location.html">module/location</a>
						</li>
						
						<li>
							<a href="Test.html">module/Test</a>
						</li>
						

					</ul>
				</li>
				
				<li class="dropdown">
					<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="aQuery.html">aQuery</a>
						</li>
						

					</ul>
				</li>
				
				<li class="dropdown">
					<a href="mixins.list.html" class="dropdown-toggle" data-toggle="dropdown">Mixins<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="CollectionClassPrototypeMethods.html">CollectionClassPrototypeMethods</a>
						</li>
						
						<li>
							<a href="ObjectClassStaticMethods.html">ObjectClassStaticMethods</a>
						</li>
						

					</ul>
				</li>
				
				<li class="dropdown">
					<a href="events.list.html" class="dropdown-toggle" data-toggle="dropdown">Events<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="aQuery.html#event:"ajaxStart"">"ajaxStart"</a>
						</li>
						
						<li>
							<a href="aQuery.html#event:"ajaxStop"">"ajaxStop"</a>
						</li>
						
						<li>
							<a href="aQuery.html#event:"ajaxTimeout"">"ajaxTimeout"</a>
						</li>
						
						<li>
							<a href="aQuery.html#event:"jsonpStart"">"jsonpStart"</a>
						</li>
						
						<li>
							<a href="aQuery.html#event:"jsonpStop"">"jsonpStop"</a>
						</li>
						
						<li>
							<a href="aQuery.html#event:"jsonpTimeout"">"jsonpTimeout"</a>
						</li>
						
						<li>
							<a href="aQuery.html#event:"test.report"">"test.report"</a>
						</li>
						

					</ul>
				</li>
				
				<li class="dropdown">
					<a href="global.html" class="dropdown-toggle" data-toggle="dropdown">Global<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="global.html#AjaxOptions">AjaxOptions</a>
						</li>
						
						<li>
							<a href="global.html#debug">debug</a>
						</li>
						
						<li>
							<a href="global.html#define">define</a>
						</li>
						
						<li>
							<a href="global.html#define">define(1)</a>
						</li>
						
						<li>
							<a href="global.html#define">define(2)</a>
						</li>
						
						<li>
							<a href="global.html#define">define(3)</a>
						</li>
						
						<li>
							<a href="global.html#error">error</a>
						</li>
						
						<li>
							<a href="global.html#info">info</a>
						</li>
						
						<li>
							<a href="global.html#JSONPOptions">JSONPOptions</a>
						</li>
						
						<li>
							<a href="global.html#logger">logger</a>
						</li>
						
						<li>
							<a href="global.html#require">require</a>
						</li>
						

					</ul>
				</li>
				
			</ul>
		</div>
	</div>

	<div class="row-fluid">

		
			<div class="span12">
				
				<div id="main">
					


		<h1 class="page-title">Source: module/Test.js</h1>
    
    <section>
        <article>
            <pre class="sunlight-highlight-javascript linenums">aQuery.define( "module/Test", [ "base/Promise", "base/config", "main/event" ], function( $, Promise, config, event ) {
	"use strict";
	this.describe( "Test Module" );
	var TestEventType = "test.report";
	var logger, error, info, debug;
	if ( window.console && window.console.log.bind && !config.module.testLogByHTML ) {
		logger = $.logger;
		error = $.error;
		info = $.info;
		debug = $.debug;
	} else {
		var dialog = $.createEle( "pre" );

		dialog.style.cssText = "display:block;position:absolute;width:600px;height:200px;overflow:scroll;z-index:1000000;";
		dialog.style.right = "0px";
		dialog.style.top = "0px";
		document.body.appendChild( dialog );

		var colorMap = {
			log: "green",
			error: "red",
			info: "black",
			debug: "orange"
		};

		var input = function( type, arg ) {
			dialog.innerHTML = ( dialog.innerHTML + '&lt;p style="color:' + colorMap[ type ] + '" >' + "&lt;strong>" + type + ":&lt;strong>" + arg.join( " " ) + '&lt;/p>' + "\n" );
			dialog.scrollTop = dialog.scrollHeight;
		};

		logger = function() {
			input( "log", $.util.argToArray( arguments ) );
		};

		error = function() {
			input( "error", $.util.argToArray( arguments ) );
		};

		info = function() {
			input( "info", $.util.argToArray( arguments ) );
		};

		debug = function() {
			input( "debug", $.util.argToArray( arguments ) );
		};

	}
	/**
	 * Event reporting that a test has been trigger.
	 * @event aQuery#"test.report"
	 * @param {String} name  - Test name.
	 * @param {Number} count - Test count.
	 * @param {Number} fail  - fail count.
	 */

	/**
	 * You can see Test.html.
	 * @public
	 * @module module/Test
	 * @requires module:base/Promise
	 * @requires module:base/config
	 */

	/**
	 * Test Module.
	 * @constructor
	 * @param {String} - Name of the test.
	 * @param {Function=} - The complete function of resoving all promise.
	 * @alias module:module/Test
	 */
	function Test( name, complete ) {
		this.name = "[" + name + "]";
		this.complete = complete || function() {};
		this.promise = new Promise( function( preResult ) {
			logger( this.name, "userAgent", navigator.userAgent );
			logger( this.name, "Test start", "Test:" + this.count );
			return preResult;
		} ).withContext( this );
		this.count = 0;
		this.fail = 0;
	}

	$.util.extend( Test, /** @lends module:module/Test */{
		/**
		 * console.log or log in html.
		 * @method logger
		 * @param {...String}
		 * @memberOf module:module/Test
		 */
		logger: logger,
		/**
		 * console.error or error in html.
		 * @method error
		 * @param {...String}
		 * @memberOf module:module/Test
		 */
		error: error,
		/**
		 * console.info or info in html.
		 * @method info
		 * @param {...String}
		 * @memberOf module:module/Test
		 */
		info: info,
		/**
		 * console.debug or debug in html.
		 * @method debug
		 * @param {...String}
		 * @memberOf module:module/Test
		 */
		debug: debug,
		/** {undefined|DOMElement} */
		dialog: dialog
	} );

	var ssuccess = "âˆš",
		sfail = "X";

	Test.prototype = /** @lends module:module/Test.prototype */ {
		constructor: Test,
		/**
		 * Execute a function and non-return.
		 * @param {String} - The describe of this test.
		 * @param {Function} - The function of this test.
		 * @param {Promise=} - If get a Promise instance then this test will be async.
		 * @returns {this}
		 * @example
		 * var promise1 = new Promise;
		 * new Test("TestTest", function(preResult){
		 *   // complete
		 * })
		 * .execute("Test execute async. After 1 seconds, 'promise1.resolve'. ", function(){
		 *   setTimeout(function(){
		 *     promise1.resolve();
		 *   }, 1000);
		 * })
		 * .execute("Test execute async. After 1 seconds, the next test is executed. ", function(){
		 *
		 * }, promise1)
		 * .start();
		 */
		execute: function( describe, executeFn, promise ) {
			this.count++;
			this.promise = this.promise.then( function( preResult ) {
				if ( Promise.forinstance( promise ) ) {
					promise.then( function( result ) {
						this._execute( describe, executeFn, result != null ? result : preResult );
					} ).withContext( this );
					return promise;
				} else {
					this._execute( describe, executeFn, preResult );
					return preResult;
				}
			} );
			return this;
		},
		_execute: function( describe, executeFn, preResult ) {
			try {
				executeFn( preResult );
				logger( this.name, describe, ssuccess );
			} catch ( e ) {
				this.fail++;
				error( this.name, describe, sfail, e );
				this.report();
				throw e;
			}
		},
		/**
		 * Execute a function and return a result.
		 * @param {String} - The describe of this test.
		 * @param {*} - The result.
		 * @param {Function} - The function of this test.
		 * @param {Promise=} - If get a Promise instance then this test will be async.
		 * @returns {this}
		 * @example
		 * var promise1 = new Promise;
		 * new Test("TestTest", function(preResult){
		 *   // complete
		 * })
		 * .equal("Test equal async. After 1 seconds, 'promise1.resolve'. ", true, function(){
		 *   setTimeout(function(){
		 *     promise1.resolve();
		 *   }, 1000);
		 *   return true;
		 * })
		 * .equal("Test equal async. After 1 seconds, the next test is executed and preResult is true. ", true, function(preResult){
		 *   return preResult;
		 * }, promise1)
		 * .start();
		 */
		equal: function( describe, value, resultBackFn, promise ) {
			this.count++;
			this.promise = this.promise.then( function( preResult ) {
				if ( Promise.forinstance( promise ) ) {
					promise.then( function( result ) {
						return this._equal( describe, value, resultBackFn, result != null ? result : preResult );
					} ).withContext( this );
					return promise;
				} else {
					return this._equal( describe, value, resultBackFn, preResult );
				}
			} );
			return this;
		},
		_equal: function( describe, value, resultBackFn, preResult ) {
			try {
				var result = resultBackFn( preResult );
			} catch ( e ) {
				this.fail++;
				error( this.name, describe, sfail, e );
				this.report();
				throw e;
			}
			if ( result === value ) {
				logger( this.name, describe, ssuccess );
			} else {
				this.fail++;
				error( this.name, describe, sfail );
				this.report();
			}
			return result;
		},
		/**
		 * Start test
		 * @param {*} - The first result.
		 * @returns {this}
		 */
		start: function( firstResult ) {
			this.promise.then( function() {
				Test[ this.fail == 0 ? "logger" : "error" ]( this.name, "Test stop", "Test:" + this.count, "Success" + ( this.count - this.fail ), "Fail:" + this.fail );
				this.complete();
				this.report();
			} );
			this.promise.root().resolve( firstResult );
			return this;
		},
		/**
		 * If window.parent.aQuery is exists then trigger "test" event.
		 * @inner
		 * @fires aQuery#"test.report"
		 * @returns {this}
		 */
		report: function() {
			if ( window.parent && window.parent.aQuery && window.parent.aQuery.trigger ) {
				window.parent.aQuery.trigger( TestEventType, null, this.name, this.count, this.fail );
			}
			return this;
		}
	};

	return Test;
} );</pre>
        </article>
    </section>





				</div>

				<div class="clearfix"></div>
				<footer>
					
					
		<span class="jsdoc-message">
		Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.2</a>
		</span>
				</footer>
			</div>

			
			<br clear="both">
		</div>

	</div>
	<script src="scripts/sunlight.js"></script>
	<script src="scripts/sunlight.javascript.js"></script>
	<script src="scripts/sunlight-plugin.doclinks.js"></script>
	<script src="scripts/sunlight-plugin.linenumbers.js"></script>
	<script src="scripts/sunlight-plugin.menu.js"></script>
	<script src="scripts/jquery.min.js"></script>
	<script src="scripts/jquery.scrollTo.js"></script>
	<script src="scripts/jquery.localScroll.js"></script>
	<script src="scripts/bootstrap-dropdown.js"></script>
	<script src="scripts/toc.js"></script>


	<script>  Sunlight.highlightAll({lineNumbers:true,  showMenu: true, enableDoclinks :true}); </script>

	<script>
		$( function () {
			$( "#toc" ).toc( {
				selectors   : "h1,h2,h3,h4",
				showAndHide : false,
				scrollTo    : 60
			} );
			$( "#toc>ul" ).addClass( "nav nav-pills nav-stacked" );
			$( "#main span[id^='toc']" ).addClass( "toc-shim" );

		} );
	</script>

	

</body>
</html>
